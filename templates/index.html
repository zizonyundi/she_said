<!DOCTYPE html>
<html lang="ko">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="{{ url_for('static', filename='module.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    </head>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- 구글폰트 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap"
          rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Red+Rose:wght@300;400;700&display=swap" rel="stylesheet">
    <title>여성의 말 아카이브 She Said</title>
    <style>

        #modal {
            display: block;
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: rgba(0, 0, 0, 0.3);
        }

        .modal-wrap {
            display: block;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70vw;
            height: 90vw;
            background: #fff;
        }

        .save_btn {
            display: block;
            position: absolute;
        }

        .modal-content {
            display: block;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60vw;
            height: 60vw;
            background: orange;
        }


        .modal-content .saying {
            font-size: 32px;
            padding: 20px;
        }

        .modal-content .who {
            font-size: 15px;
            line-height: 1.3;
            padding: 30px;
        }

        .modal-content .from {
            font-size: 15px;
            line-height: 1.3;
            padding: 30px;
        }

        .close {
            display: block;
            position: absolute;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 3px solid #000;
            text-align: center;
            line-height: 30px;
            text-decoration: none;
            color: #000;
            font-size: 20px;
            font-weight: bold;
            right: 10px;
            top: 10px;
        }


        @media screen and (min-width: 769px) {
            .modal-wrap {
                width: 560px;
                height: 720px;
                background: #fff;
            }

            .modal-content {
                width: 480px;
                height: 480px;
            }

        }

    </style>
    </head>
    <body>
        <div class="total-wrap">
            <div class="top-wrap">
                <div class="top-wrap-web margin-both-16">
                    <p class="logo">SheSaid,</p>
                    <p class="top-text">내가 얼마나 더 멀리 갈지 아무도 장담할 수 없어.</p>
                    <div class="text-info">
                        <div class="text-line"></div>
                        <p class="text-who">모아나 </p>
                        <p class="text-from">모아나(Moana, 2016)</p>
                    </div>
                </div>
            </div>
            <div class="bottom-wrap">
                <div class="category-wrap" id="keyword">
                    <p class="category" onclick="showSayings()">전체</p>
                    <p class="category select" onclick="sortSayings('영화')">영화</p>
                    <p class="category" onclick="sortSayings('드라마')">드라마</p>
                </div>

                <div class="list-wrap" id="card-box">
                    <figure class="card-box">
                        <div class="margin-both-24">
                            <p class="card-text">일 내 욕망엔 계기가 없어.<br/>
                                내 욕망은 내가 만드는 거야.<br/>
                                내 욕망엔 계기가 없어.<br/>
                                내 욕망은 내가 만드는 거야.</p>
                            <div class="card-info">
                                <img class="list-profile"
                                     src="https://search.pstatic.net/common?type=ofullfill&amp;size=137x153&amp;quality=90&amp;direct=true&amp;src=http%3A%2F%2Fsstatic.naver.net%2Fkeypage%2Fimage%2Fdss%2F60%2F77%2F59%2F00%2F60_9775900_main_image_new_1558591252839.jpg">
                                <div class="card-info-text">
                                    <p class="card-who">배타미(임수정)</p>
                                    <p class="card-from">검색어를 입력하세요 WWW</p></div>
                            </div>
                        </div>
                    </figure>
                    <figure class="card-box">
                        <div class="margin-both-24">
                            <p class="card-text">이 내 욕망엔 계기가 없어.<br/>
                                내 욕망은 내가 만드는 거야.</p>
                            <div class="card-info">
                                <img class="list-profile"
                                     src="https://search.pstatic.net/common?type=ofullfill&amp;size=137x153&amp;quality=90&amp;direct=true&amp;src=http%3A%2F%2Fsstatic.naver.net%2Fkeypage%2Fimage%2Fdss%2F60%2F77%2F59%2F00%2F60_9775900_main_image_new_1558591252839.jpg">
                                <div class="card-info-text">
                                    <p class="card-who">배타미(임수정)</p>
                                    <p class="card-from">검색어를 입력하세요 WWW</p></div>
                            </div>
                        </div>
                    </figure>
                    <figure class="card-box">
                        <div class="margin-both-24">
                            <p class="card-text">삼 내 욕망엔 계기가 없어.<br/>
                                내 욕망은 내가 만드는 거야.</p>
                            <div class="card-info">
                                <img class="list-profile"
                                     src="https://search.pstatic.net/common?type=ofullfill&amp;size=137x153&amp;quality=90&amp;direct=true&amp;src=http%3A%2F%2Fsstatic.naver.net%2Fkeypage%2Fimage%2Fdss%2F60%2F77%2F59%2F00%2F60_9775900_main_image_new_1558591252839.jpg">
                                <div class="card-info-text">
                                    <p class="card-who">배타미(임수정)</p>
                                    <p class="card-from">검색어를 입력하세요 WWW</p></div>
                            </div>
                        </div>
                    </figure>
                    <figure class="card-box">
                        <div class="margin-both-24">
                            <p class="card-text">사 내 욕망엔 계기가 없어.<br/>
                                내 욕망은 내가 만드는 거야.</p>
                            <div class="card-info">
                                <img class="list-profile"
                                     src="https://search.pstatic.net/common?type=ofullfill&amp;size=137x153&amp;quality=90&amp;direct=true&amp;src=http%3A%2F%2Fsstatic.naver.net%2Fkeypage%2Fimage%2Fdss%2F60%2F77%2F59%2F00%2F60_9775900_main_image_new_1558591252839.jpg">
                                <div class="card-info-text">
                                    <p class="card-who">배타미(임수정)</p>
                                    <p class="card-from">검색어를 입력하세요 WWW</p></div>
                            </div>
                        </div>
                    </figure>
                    <figure class="card-box">
                        <div class="margin-both-24">
                            <p class="card-text">오 내 욕망엔 계기가 없어.<br/>
                                내 욕망은 내가 만드는 거야.<br/>
                                내 욕망엔 계기가 없어.<br/>
                                내 욕망은 내가 만드는 거야.</p>
                            <div class="card-info">
                                <img class="list-profile"
                                     src="https://search.pstatic.net/common?type=ofullfill&amp;size=137x153&amp;quality=90&amp;direct=true&amp;src=http%3A%2F%2Fsstatic.naver.net%2Fkeypage%2Fimage%2Fdss%2F60%2F77%2F59%2F00%2F60_9775900_main_image_new_1558591252839.jpg">
                                <div class="card-info-text">
                                    <p class="card-who">배타미(임수정)</p>
                                    <p class="card-from">검색어를 입력하세요 WWW</p></div>
                            </div>
                        </div>
                    </figure>
                    <figure class="card-box">
                        <div class="margin-both-24">
                            <p class="card-text">육 내 욕망엔 계기가 없어.<br/>
                                내 욕망은 내가 만드는 거야.</p>
                            <div class="card-info">
                                <img class="list-profile"
                                     src="https://search.pstatic.net/common?type=ofullfill&amp;size=137x153&amp;quality=90&amp;direct=true&amp;src=http%3A%2F%2Fsstatic.naver.net%2Fkeypage%2Fimage%2Fdss%2F60%2F77%2F59%2F00%2F60_9775900_main_image_new_1558591252839.jpg">
                                <div class="card-info-text">
                                    <p class="card-who">배타미(임수정)</p>
                                    <p class="card-from">검색어를 입력하세요 WWW</p></div>
                            </div>
                        </div>
                    </figure>
                    <figure class="card-box">
                        <div class="margin-both-24">
                            <p class="card-text">칠 내 욕망엔 계기가 없어.<br/>
                                내 욕망은 내가 만드는 거야.</p>
                            <div class="card-info">
                                <img class="list-profile"
                                     src="https://search.pstatic.net/common?type=ofullfill&amp;size=137x153&amp;quality=90&amp;direct=true&amp;src=http%3A%2F%2Fsstatic.naver.net%2Fkeypage%2Fimage%2Fdss%2F60%2F77%2F59%2F00%2F60_9775900_main_image_new_1558591252839.jpg">
                                <div class="card-info-text">
                                    <p class="card-who">배타미(임수정)</p>
                                    <p class="card-from">검색어를 입력하세요 WWW</p></div>
                            </div>
                        </div>
                    </figure>
                    <figure class="card-box">
                        <div class="margin-both-24">
                            <p class="card-text">팔 내 욕망엔 계기가 없어.<br/>
                                내 욕망은 내가 만드는 거야.</p>
                            <div class="card-info">
                                <img class="list-profile"
                                     src="https://search.pstatic.net/common?type=ofullfill&amp;size=137x153&amp;quality=90&amp;direct=true&amp;src=http%3A%2F%2Fsstatic.naver.net%2Fkeypage%2Fimage%2Fdss%2F60%2F77%2F59%2F00%2F60_9775900_main_image_new_1558591252839.jpg">
                                <div class="card-info-text">
                                    <p class="card-who">배타미(임수정)</p>
                                    <p class="card-from">검색어를 입력하세요 WWW</p></div>
                            </div>
                        </div>
                    </figure>
                </div>
            </div>
            <!--            <div id="wrap">-->
            <!--                <a href="javascript:openModal('modal1');" class="button modal-open">모달열기1</a>-->
            <!--                <a href="javascript:openModal('modal2');" class="button modal-open">모달열기2</a>-->
            <!--            </div>-->

            <div id="modal">
                <div class="modal-wrap">
                    <a href="javascript:;" class="close">X</a>

                    <div class="modal-content" id="modal-content">

                        <p class="saying">내가 얼마나 더 멀리 갈지 아무도 장담할 수 없어. </p>
                        <div class="who">모아나</div>
                        <div class="from">모아나(Moana, 2016)</div>
                    </div>
                    <div class="save_btn"><a class="hover" href='javascript:void(0);'
                                             onclick="PrintDiv($('#modal-content'));">이미지로
                        저장</a></div>
                </div>
            </div>
        </div>
        <script>
            $(document).ready(function () {

                $(".category").off("click").on("click", function () {
                    if ($(this).hasClass("select")) {
                        // $(this).removeClass("select");
                        // $(".category").not($(this)).addClass("select");
                    } else {
                        $(this).addClass("select");
                        $(".category").not($(this)).removeClass("select");
                    }
                });

                showSayings();
                sortSayings();
            });


            function showSayings() {
                $('#card-box').empty()
                $.ajax({
                    type: 'GET',
                    url: '/list',
                    data: {},
                    success: function (response) {
                        let sayings = response['sayings_list']
                        for (let i = 0; i < sayings.length; i++) {
                            let saying = sayings[i]

                            let saying_kr = saying['saying_kr']
                            let img = saying['img']
                            let who = saying['who']
                            let from = saying['from']

                            let made_id = 'card-' + i
                            let tempHtml = `<figure class="card-box" id="${made_id}" onclick="openModal('modal'); reply_click(this.id);">
                        <div class="margin-both-24">
                            <p class="card-text">${saying_kr}</p>
                            <div class="card-info">
                                <img class="list-profile"
                                     src="${img}">
                                <div class="card-info-text">
                                    <p class="card-who">${who}</p>
                                    <p class="card-from">${from}</p></div>
                            </div>
                        </div>
                    </figure>`
                            $('#card-box').append(tempHtml)

                        }


                    }

                });

            }


            function sortSayings(category) {
                $('#card-box').empty()

                $.ajax({
                    type: 'GET',
                    url: '/category?category=' + category,
                    data: {},
                    success: function (response) {
                        let sayings = response['sayings_list']
                        for (let i = 0; i < sayings.length; i++) {
                            let saying = sayings[i]

                            let saying_kr = saying['saying_kr']
                            let img = saying['img']
                            let who = saying['who']
                            let from = saying['from']

                            let made_id = 'card-' + i
                            let tempHtml =
                                `<figure class="card-box" id="${made_id}" onclick="openModal('modal'); reply_click(this.id)";>
                        <div class="margin-both-24">
                            <p class="card-text" id="card-text">${saying_kr}</p>
                            <div class="card-info">
                                <img class="list-profile"
                                     src="${img}">
                                <div class="card-info-text">
                                    <p class="card-who">${who}</p>
                                    <p class="card-from">${from}</p></div>
                            </div>
                        </div>
                    </figure>`
                            $('#card-box').append(tempHtml)

                        }

                    }
                });

            }

            //이미지(png)로 다운로드
            function PrintDiv(div) {
                div = div[0]
                // html2canvas(div, node.ownerDocument, options, options.width != undefined ? options.width : node.ownerDocument.defaultView.innerWidth, options.height != undefined ? options.height : node.ownerDocument.defaultView.innerHeight, index).then(function (canvas) {
                // html2canvas(div).then(function (canvas) {
                window.scrollTo(0,0);
                html2canvas(div).then(function (canvas) {
                    var myImage = canvas.toDataURL();
                    downloadURI(myImage, "저장이미지이름.png")
                });
                window.scrollTo(0, document.body.scrollHeight || document.documentElement.scrollHeight);
            }

            function downloadURI(uri, name) {
                var link = document.createElement("a")
                link.download = name;
                link.href = uri;
                document.body.appendChild(link);
                link.click();
            }


            function openModal(modalname) {
                document.get
                $("#modal").fadeIn(300);
                $("." + modalname).fadeIn(300);
            };


            function reply_click(clicked_id) {
                let saying = $('#' + clicked_id).find('.card-text').text();
                let who = $('#' + clicked_id).find('.card-who').text();
                let from = $('#' + clicked_id).find('.card-from').text();

                $('#modal').empty()
                let tempHtmlModal =
                    `           <div class="modal-wrap" style="display:block;">
                    <a href="javascript:;" class="close">X</a>

                    <div class="modal-content" id="modal-content">

                        <p class="saying">${saying}</p>
                        <div class="who">${who}</div>
                        <div class="from">${from}</div>
                    </div>
                    <div class="save_btn"><a class="hover" href='javascript:void(0);'
                                             onclick="PrintDiv($('#modal-content'));">이미지로
                        저장</a></div>
                </div>`
                $('#modal').append(tempHtmlModal)
            };


            $("#modal, .close").on('click', function () {
                $("#modal").fadeOut(300);
                $(".modal-con").fadeOut(300);
            });


        </script>
    </body>
</html>